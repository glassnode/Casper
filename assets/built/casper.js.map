{"version":3,"sources":["newsletter-setup.js","jquery.fitvids.js","dark-mode.js","infinite-scroll.js"],"names":["addFormEventListener","document","formName","afterSuccess","afterError","form","getElementById","emailField","button","addEventListener","e","preventDefault","email","value","disabled","fetch","body","JSON","stringify","type","headers","Content-Type","method","then","response","ok","json","result","error","err","console","createAfterSuccess","formKey","mainElement","successElement","classList","add","remove","localStorage","setItem","createAfterError","warningElement","warningMessage","innerText","msg","$","fn","fitVids","options","head","div","settings","customSelector","ignore","getElementsByTagName","createElement","innerHTML","appendChild","childNodes","extend","this","each","selectors","push","ignoreList","$allVideos","find","join","not","aspectRatio","videoName","$this","parents","length","tagName","toLowerCase","parent","css","isNaN","attr","parseInt","height","width","_count","wrap","removeAttr","window","jQuery","Zepto","key","className","prefersDarkMode","matchMedia","html","querySelector","toggler","getItem","matches","toggle","contains","feedElement","buffer","ticking","loading","lastScrollY","lastWindowHeight","lastDocumentHeight","nextElement","onPageLoad","status","removeEventListener","onScroll","onResize","querySelectorAll","forEach","item","importNode","resNextElement","href","documentElement","scrollHeight","onUpdate","xhr","XMLHttpRequest","responseType","open","send","requestTick","requestAnimationFrame","scrollY","innerHeight","passive","formsMeta","newsletter-post-card","localStorageDismissKey","init","bannerHidden","postCardCta","newsletter-banner","banner","setTimeout","dismissButton","map"],"mappings":"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","file":"casper.js","sourcesContent":["(function (window, document) {\n    const forms = [\n        'newsletter-post-card',\n        'newsletter-banner',\n    ]\n\n    const formsMeta = {\n        'newsletter-post-card': {\n            localStorageDismissKey: 'newsletterPostBlockHidden',\n            init: (localStorageDismissKey) => {\n                let bannerHidden = localStorage.getItem(localStorageDismissKey) === 'true';\n                let postCardCta = document.querySelector('.newsletter-post-card');\n\n                if (!bannerHidden && postCardCta) {\n                    postCardCta.classList.remove('d-none');\n                }\n            },\n       },\n        'newsletter-banner': {\n            localStorageDismissKey: 'newsletterFloatBannerHidden',\n            init: (localStorageDismissKey) => {\n                let bannerHidden = localStorage.getItem(localStorageDismissKey) === 'true';\n\n                let banner = document.querySelector('.newsletter-banner');\n\n                if (!bannerHidden && banner) {\n                    banner.classList.remove('d-none');\n\n                    if (localStorage.getItem('newsletterFloatBannerAnimation') !== 'false') {\n                        banner.classList.add('newsletter-banner--hidden')\n                        setTimeout(() => {\n                            banner.classList.remove('newsletter-banner--hidden');\n                            localStorage.setItem('newsletterFloatBannerAnimation', 'false');\n                        }, 2500);\n                    }\n\n                    let dismissButton = document.querySelector('.newsletter-banner__dismiss button');\n                    dismissButton.addEventListener('click', () => {\n                        banner.classList.add('d-none');\n                        localStorage.setItem(localStorageDismissKey, 'true');\n                    })\n                }\n            },\n        },\n    };\n\n    forms.map(formName => {\n        const formElement = document.getElementById(formName + '-form');\n        if (formElement) {\n            const form = formsMeta[formName];\n            form.init(form.localStorageDismissKey);\n            addFormEventListener(\n                document,\n                formName,\n                createAfterSuccess(formName, form.localStorageDismissKey),\n                createAfterError(formName)\n            );\n        }\n    });\n})(window, document);\n\nfunction addFormEventListener(document, formName, afterSuccess = null, afterError = null) {\n    const form = document.getElementById(formName + '-form');\n    const emailField = document.getElementById(formName + '-email');\n    const button = document.getElementById(formName + '-submit');\n\n    if (form) {\n        form.addEventListener('submit', (e) => {\n            e.preventDefault();\n            let email = emailField.value;\n            button.disabled = true;\n\n            fetch('https://forms.glassnode.com/api/subscribe', {\n                body: JSON.stringify({ email: email, type: 'newsletter' }),\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                method: 'POST',\n            }).then(response => {\n                button.disabled = false;\n                if (response.ok && afterSuccess) {\n                    afterSuccess();\n                }\n                return response.json();\n            }).then(result => {\n                if (!result.ok && afterError) {\n                    afterError(result.error);\n                }\n            }).then(err => {\n                if (err) {\n                    console.error(err);\n                }\n            });\n        });\n    }\n}\n\nfunction createAfterSuccess(formName, formKey) {\n    return () => {\n        const mainElement = document.getElementById(formName + '-main');\n        const successElement = document.getElementById(formName + '-success');\n\n        mainElement.classList.add('d-none');\n        successElement.classList.remove('d-none');\n\n        localStorage.setItem(formKey, 'true');\n    }\n}\n\nfunction createAfterError(formName) {\n    return (msg) => {\n        const warningElement = document.getElementById(formName + '-warning');\n        const warningMessage = document.getElementById(formName + '-warning-msg');\n\n        warningMessage.innerText = msg;\n        warningElement.classList.remove('d-none');\n    }\n}\n","/*jshint browser:true */\n/*!\n* FitVids 1.3\n*\n*\n* Copyright 2017, Chris Coyier + Dave Rupert + Ghost Foundation\n* This is an unofficial release, ported by John O'Nolan\n* Credit to Thierry Koblentz - http://www.alistapart.com/articles/creating-intrinsic-ratios-for-video/\n* Released under the MIT license\n*\n*/\n\n;(function( $ ){\n\n  'use strict';\n\n  $.fn.fitVids = function( options ) {\n    var settings = {\n      customSelector: null,\n      ignore: null\n    };\n\n    if(!document.getElementById('fit-vids-style')) {\n      // appendStyles: https://github.com/toddmotto/fluidvids/blob/master/dist/fluidvids.js\n      var head = document.head || document.getElementsByTagName('head')[0];\n      var css = '.fluid-width-video-container{flex-grow: 1;width:100%;}.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}';\n      var div = document.createElement(\"div\");\n      div.innerHTML = '<p>x</p><style id=\"fit-vids-style\">' + css + '</style>';\n      head.appendChild(div.childNodes[1]);\n    }\n\n    if ( options ) {\n      $.extend( settings, options );\n    }\n\n    return this.each(function(){\n      var selectors = [\n        'iframe[src*=\"player.vimeo.com\"]',\n        'iframe[src*=\"youtube.com\"]',\n        'iframe[src*=\"youtube-nocookie.com\"]',\n        'iframe[src*=\"kickstarter.com\"][src*=\"video.html\"]',\n        'object',\n        'embed'\n      ];\n\n      if (settings.customSelector) {\n        selectors.push(settings.customSelector);\n      }\n\n      var ignoreList = '.fitvidsignore';\n\n      if(settings.ignore) {\n        ignoreList = ignoreList + ', ' + settings.ignore;\n      }\n\n      var $allVideos = $(this).find(selectors.join(','));\n      $allVideos = $allVideos.not('object object'); // SwfObj conflict patch\n      $allVideos = $allVideos.not(ignoreList); // Disable FitVids on this video.\n\n      $allVideos.each(function(){\n        var $this = $(this);\n        if($this.parents(ignoreList).length > 0) {\n          return; // Disable FitVids on this video.\n        }\n        if (this.tagName.toLowerCase() === 'embed' && $this.parent('object').length || $this.parent('.fluid-width-video-wrapper').length) { return; }\n        if ((!$this.css('height') && !$this.css('width')) && (isNaN($this.attr('height')) || isNaN($this.attr('width'))))\n        {\n          $this.attr('height', 9);\n          $this.attr('width', 16);\n        }\n        var height = ( this.tagName.toLowerCase() === 'object' || ($this.attr('height') && !isNaN(parseInt($this.attr('height'), 10))) ) ? parseInt($this.attr('height'), 10) : $this.height(),\n            width = !isNaN(parseInt($this.attr('width'), 10)) ? parseInt($this.attr('width'), 10) : $this.width(),\n            aspectRatio = height / width;\n        if(!$this.attr('name')){\n          var videoName = 'fitvid' + $.fn.fitVids._count;\n          $this.attr('name', videoName);\n          $.fn.fitVids._count++;\n        }\n        $this.wrap('<div class=\"fluid-width-video-container\"><div class=\"fluid-width-video-wrapper\"></div></div>').parent('.fluid-width-video-wrapper').css('padding-top', (aspectRatio * 100)+'%');\n        $this.removeAttr('height').removeAttr('width');\n      });\n    });\n  };\n\n  // Internal counter for unique video names.\n  $.fn.fitVids._count = 0;\n\n// Works with either jQuery or Zepto\n})( window.jQuery || window.Zepto );\n","/* eslint-env browser */\n(function (window, document) {\n    var key = \"glassnode.dark-mode\";\n    var className = \"dark-mode\";\n\n    var prefersDarkMode = window.matchMedia(\"(prefers-color-scheme: dark)\");\n\n    var html = document.querySelector(\"html\");\n    var toggler = document.querySelector(\".js-toggle-mode\");\n\n    if (localStorage.getItem(key) === \"true\" || prefersDarkMode.matches) {\n        html.classList.toggle(className);\n    }\n\n    toggler.addEventListener(\"click\", () => {\n        localStorage.setItem(key, !html.classList.contains(className));\n        html.classList.toggle(className);\n    });\n})(window, document);\n","/* eslint-env browser */\n\n/**\n * Infinite Scroll\n * Used on all pages where there is a list of posts (homepage, tag index, etc).\n *\n * When the page is scrolled to 300px from the bottom, the next page of posts\n * is fetched by following the the <link rel=\"next\" href=\"...\"> that is output\n * by {{ghost_head}}.\n *\n * The individual post items are extracted from the fetched pages by looking for\n * a wrapper element with the class \"post-card\". Any found elements are appended\n * to the element with the class \"post-feed\" in the currently viewed page.\n */\n\n(function (window, document) {\n    // next link element\n    var nextElement = document.querySelector('link[rel=next]');\n    if (!nextElement) {\n        return;\n    }\n\n    // post feed element\n    var feedElement = document.querySelector('.post-feed');\n    if (!feedElement) {\n        return;\n    }\n\n    var buffer = 300;\n\n    var ticking = false;\n    var loading = false;\n\n    var lastScrollY = window.scrollY;\n    var lastWindowHeight = window.innerHeight;\n    var lastDocumentHeight = document.documentElement.scrollHeight;\n\n    function onPageLoad() {\n        if (this.status === 404) {\n            window.removeEventListener('scroll', onScroll);\n            window.removeEventListener('resize', onResize);\n            return;\n        }\n\n        // append contents\n        var postElements = this.response.querySelectorAll('article.post-card');\n        postElements.forEach(function (item) {\n            // document.importNode is important, without it the item's owner\n            // document will be different which can break resizing of\n            // `object-fit: cover` images in Safari\n            feedElement.appendChild(document.importNode(item, true));\n        });\n\n        // set next link\n        var resNextElement = this.response.querySelector('link[rel=next]');\n        if (resNextElement) {\n            nextElement.href = resNextElement.href;\n        } else {\n            window.removeEventListener('scroll', onScroll);\n            window.removeEventListener('resize', onResize);\n        }\n\n        // sync status\n        lastDocumentHeight = document.documentElement.scrollHeight;\n        ticking = false;\n        loading = false;\n    }\n\n    function onUpdate() {\n        // return if already loading\n        if (loading) {\n            return;\n        }\n\n        // return if not scroll to the bottom\n        if (lastScrollY + lastWindowHeight <= lastDocumentHeight - buffer) {\n            ticking = false;\n            return;\n        }\n\n        loading = true;\n\n        var xhr = new window.XMLHttpRequest();\n        xhr.responseType = 'document';\n\n        xhr.addEventListener('load', onPageLoad);\n\n        xhr.open('GET', nextElement.href);\n        xhr.send(null);\n    }\n\n    function requestTick() {\n        ticking || window.requestAnimationFrame(onUpdate);\n        ticking = true;\n    }\n\n    function onScroll() {\n        lastScrollY = window.scrollY;\n        requestTick();\n    }\n\n    function onResize() {\n        lastWindowHeight = window.innerHeight;\n        lastDocumentHeight = document.documentElement.scrollHeight;\n        requestTick();\n    }\n\n    window.addEventListener('scroll', onScroll, {passive: true});\n    window.addEventListener('resize', onResize);\n\n    requestTick();\n})(window, document);\n"]}